# ç¾¤ç»„æœåŠ¡ API æ–‡æ¡£

## ğŸ“‹ æœåŠ¡åŠŸèƒ½è¯´æ˜

ç¾¤ç»„æœåŠ¡è´Ÿè´£ç®¡ç†IMç³»ç»Ÿä¸­çš„æ‰€æœ‰ç¾¤ç»„ç›¸å…³åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç¾¤ç»„åˆ›å»ºã€æˆå‘˜ç®¡ç†ã€æƒé™æ§åˆ¶ã€ç¾¤ç»„è®¾ç½®ç­‰ã€‚æœ¬æœåŠ¡æ”¯æŒå¤šç§ç¾¤ç»„ç±»å‹ï¼Œæä¾›å®Œå–„çš„ç¾¤ç»„ç®¡ç†èƒ½åŠ›ï¼Œæ˜¯å¤šäººåä½œå’Œç¤¾äº¤çš„æ ¸å¿ƒæœåŠ¡ã€‚

### æ ¸å¿ƒåŠŸèƒ½

#### 1. ç¾¤ç»„ç®¡ç†
- **åˆ›å»ºç¾¤ç»„**: æ”¯æŒæ™®é€šç¾¤ã€è®¨è®ºç»„ã€éƒ¨é—¨ç¾¤ç­‰å¤šç§ç±»å‹
- **ç¾¤ç»„ä¿¡æ¯**: ç¾¤åç§°ã€ç¾¤å¤´åƒã€ç¾¤å…¬å‘Šã€ç¾¤ç®€ä»‹ã€ç¾¤æ ‡ç­¾
- **ç¾¤ç»„è®¾ç½®**: åŠ å…¥æ–¹å¼ï¼ˆè‡ªç”±åŠ å…¥/éœ€éªŒè¯/ç¦æ­¢åŠ å…¥ï¼‰ã€ç¾¤äººæ•°ä¸Šé™
- **è§£æ•£ç¾¤ç»„**: ç¾¤ä¸»è§£æ•£ç¾¤ç»„ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰æˆå‘˜
- **è½¬è®©ç¾¤ç»„**: ç¾¤ä¸»è½¬è®©æƒé™ç»™å…¶ä»–æˆå‘˜

#### 2. æˆå‘˜ç®¡ç†
- **æ·»åŠ æˆå‘˜**: é‚€è¯·å¥½å‹ã€æ‰«ç å…¥ç¾¤ã€åˆ†äº«é“¾æ¥
- **ç§»é™¤æˆå‘˜**: ç¾¤ä¸»/ç®¡ç†å‘˜è¸¢å‡ºæˆå‘˜
- **æˆå‘˜åˆ—è¡¨**: åˆ†é¡µæŸ¥è¯¢ã€åœ¨çº¿çŠ¶æ€ã€è§’è‰²æ ‡è¯†
- **æˆå‘˜æœç´¢**: æŒ‰æ˜µç§°ã€å¤‡æ³¨æœç´¢ç¾¤æˆå‘˜
- **é€€å‡ºç¾¤ç»„**: æ™®é€šæˆå‘˜ä¸»åŠ¨é€€ç¾¤

#### 3. æƒé™ç®¡ç†
- **è§’è‰²ä½“ç³»**: ç¾¤ä¸»ã€ç®¡ç†å‘˜ã€æ™®é€šæˆå‘˜
- **è®¾ç½®ç®¡ç†å‘˜**: ç¾¤ä¸»æŒ‡å®š/å–æ¶ˆç®¡ç†å‘˜
- **æƒé™æ§åˆ¶**: 
  - ç¾¤ä¸»ï¼šæ‰€æœ‰æƒé™
  - ç®¡ç†å‘˜ï¼šè¸¢äººã€ç¦è¨€ã€å®¡æ‰¹å…¥ç¾¤
  - æ™®é€šæˆå‘˜ï¼šå‘æ¶ˆæ¯ã€æŸ¥çœ‹ä¿¡æ¯

#### 4. ç¾¤ç»„åŠŸèƒ½
- **ç¾¤å…¬å‘Š**: å‘å¸ƒ/ç¼–è¾‘/åˆ é™¤ç¾¤å…¬å‘Šï¼Œ@æ‰€æœ‰äººé€šçŸ¥
- **ç¾¤æ–‡ä»¶**: å…±äº«æ–‡ä»¶ã€æ–‡ä»¶å¤¹ç®¡ç†ã€æƒé™æ§åˆ¶
- **ç¾¤ç›¸å†Œ**: å…±äº«ç…§ç‰‡ã€è§†é¢‘ï¼Œæ”¯æŒè¯„è®º
- **ç¾¤æŠ•ç¥¨**: å‘èµ·æŠ•ç¥¨ã€ç»Ÿè®¡ç»“æœ
- **ç¾¤ç¦è¨€**: å…¨å‘˜ç¦è¨€ã€å•äººç¦è¨€ã€ç¦è¨€æ—¶é•¿è®¾ç½®
- **å…¥ç¾¤å®¡æ‰¹**: å®¡æ‰¹ç”³è¯·ã€æ‹’ç»ç†ç”±

#### 5. ç¾¤ç»„ç±»å‹
- **æ™®é€šç¾¤**: æœ€å¤š500äººï¼Œæ”¯æŒæ‰€æœ‰åŠŸèƒ½
- **è®¨è®ºç»„**: ä¸´æ—¶ç¾¤ç»„ï¼Œäººæ•°è¾ƒå°‘
- **éƒ¨é—¨ç¾¤**: å…³è”ç»„ç»‡æ¶æ„ï¼Œè‡ªåŠ¨åŒæ­¥æˆå‘˜
- **å…¬å¼€ç¾¤**: å¯æœç´¢ã€å¯è‡ªç”±åŠ å…¥

#### 6. ç¾¤ç»„è®¾ç½®
- **æ¶ˆæ¯æé†’**: æ¥æ”¶æ‰€æœ‰æ¶ˆæ¯/ä»…@æé†’/å…æ‰“æ‰°
- **ç¾¤æ˜µç§°**: è®¾ç½®ç¾¤å†…æ˜¾ç¤ºæ˜µç§°
- **ç½®é¡¶èŠå¤©**: ç¾¤èŠå¤©ç½®é¡¶
- **ä¿å­˜åˆ°é€šè®¯å½•**: å¿«é€Ÿè®¿é—®
- **æ˜¾ç¤ºç¾¤æˆå‘˜æ˜µç§°**: å¼€å¯/å…³é—­

### æŠ€æœ¯ç‰¹æ€§
- **æ•°æ®åº“**: PostgreSQLï¼ˆç¾¤ç»„ä¿¡æ¯ï¼‰+ Redisï¼ˆç¼“å­˜ï¼‰
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQï¼ˆæˆå‘˜å˜æ›´é€šçŸ¥ï¼‰
- **æ–‡ä»¶å­˜å‚¨**: OSSï¼ˆç¾¤å¤´åƒã€ç¾¤æ–‡ä»¶ï¼‰
- **æœåŠ¡å‘ç°**: Nacos
- **è´Ÿè½½å‡è¡¡**: Ribbon
- **ç†”æ–­é™çº§**: Sentinel

---

## æœåŠ¡ä¿¡æ¯
- **æœåŠ¡åç§°**: group-service
- **ç«¯å£**: 8003
- **åŸºç¡€è·¯å¾„**: /api/v1/groups
- **ç‰ˆæœ¬**: v1.0.0

---

## ç›®å½•
1. [åˆ›å»ºç¾¤ç»„](#1-åˆ›å»ºç¾¤ç»„)
2. [è·å–ç¾¤ç»„ä¿¡æ¯](#2-è·å–ç¾¤ç»„ä¿¡æ¯)
3. [æ›´æ–°ç¾¤ç»„ä¿¡æ¯](#3-æ›´æ–°ç¾¤ç»„ä¿¡æ¯)
4. [è§£æ•£ç¾¤ç»„](#4-è§£æ•£ç¾¤ç»„)
5. [æ·»åŠ æˆå‘˜](#5-æ·»åŠ æˆå‘˜)
6. [ç§»é™¤æˆå‘˜](#6-ç§»é™¤æˆå‘˜)
7. [è·å–æˆå‘˜åˆ—è¡¨](#7-è·å–æˆå‘˜åˆ—è¡¨)
8. [è®¾ç½®ç®¡ç†å‘˜](#8-è®¾ç½®ç®¡ç†å‘˜)

---

## 1. åˆ›å»ºç¾¤ç»„

### æ¥å£ä¿¡æ¯
- **URL**: `/`
- **Method**: `POST`
- **åŠŸèƒ½**: åˆ›å»ºæ–°çš„ç¾¤ç»„
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```json
{
  "name": "æŠ€æœ¯äº¤æµç¾¤",
  "description": "è®¨è®ºæŠ€æœ¯é—®é¢˜çš„ç¾¤ç»„",
  "avatar": "https://cdn.example.com/group-avatar.jpg",
  "maxMembers": 500,
  "joinType": "APPROVAL",
  "memberIds": [10002, 10003, 10004]
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | æ˜¯ | ç¾¤ç»„åç§°ï¼Œ2-30å­—ç¬¦ |
| description | string | å¦ | ç¾¤ç»„æè¿° |
| avatar | string | å¦ | ç¾¤ç»„å¤´åƒURL |
| maxMembers | integer | å¦ | æœ€å¤§æˆå‘˜æ•°ï¼Œé»˜è®¤500 |
| joinType | string | å¦ | åŠ å…¥æ–¹å¼ï¼šFREE/APPROVALï¼Œé»˜è®¤FREE |
| memberIds | array | å¦ | åˆå§‹æˆå‘˜IDåˆ—è¡¨ |

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": {
    "groupId": "group_001",
    "name": "æŠ€æœ¯äº¤æµç¾¤",
    "description": "è®¨è®ºæŠ€æœ¯é—®é¢˜çš„ç¾¤ç»„",
    "avatar": "https://cdn.example.com/group-avatar.jpg",
    "ownerId": 10001,
    "memberCount": 4,
    "maxMembers": 500,
    "joinType": "APPROVAL",
    "createdAt": "2025-11-09T15:00:00Z"
  }
}
```

---

## 2. è·å–ç¾¤ç»„ä¿¡æ¯

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}`
- **Method**: `GET`
- **åŠŸèƒ½**: è·å–ç¾¤ç»„è¯¦ç»†ä¿¡æ¯
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```
GET /api/v1/groups/group_001
```

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "groupId": "group_001",
    "name": "æŠ€æœ¯äº¤æµç¾¤",
    "description": "è®¨è®ºæŠ€æœ¯é—®é¢˜çš„ç¾¤ç»„",
    "avatar": "https://cdn.example.com/group-avatar.jpg",
    "ownerId": 10001,
    "ownerName": "å¼ ä¸‰",
    "memberCount": 50,
    "maxMembers": 500,
    "joinType": "APPROVAL",
    "announcement": "æ¬¢è¿å¤§å®¶åŠ å…¥æŠ€æœ¯äº¤æµç¾¤",
    "createdAt": "2025-01-01T00:00:00Z",
    "updatedAt": "2025-11-09T15:00:00Z"
  }
}
```

---

## 3. æ›´æ–°ç¾¤ç»„ä¿¡æ¯

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}`
- **Method**: `PUT`
- **åŠŸèƒ½**: æ›´æ–°ç¾¤ç»„ä¿¡æ¯ï¼ˆä»…ç¾¤ä¸»å’Œç®¡ç†å‘˜ï¼‰
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```json
{
  "name": "æŠ€æœ¯äº¤æµç¾¤ï¼ˆæ–°ï¼‰",
  "description": "æ›´æ–°åçš„æè¿°",
  "avatar": "https://cdn.example.com/new-avatar.jpg",
  "announcement": "æ–°çš„ç¾¤å…¬å‘Š",
  "joinType": "FREE"
}
```

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "groupId": "group_001",
    "name": "æŠ€æœ¯äº¤æµç¾¤ï¼ˆæ–°ï¼‰",
    "description": "æ›´æ–°åçš„æè¿°",
    "updatedAt": "2025-11-09T15:30:00Z"
  }
}
```

---

## 4. è§£æ•£ç¾¤ç»„

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}`
- **Method**: `DELETE`
- **åŠŸèƒ½**: è§£æ•£ç¾¤ç»„ï¼ˆä»…ç¾¤ä¸»ï¼‰
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```
DELETE /api/v1/groups/group_001
```

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "ç¾¤ç»„å·²è§£æ•£",
  "data": null
}
```

---

## 5. æ·»åŠ æˆå‘˜

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}/members`
- **Method**: `POST`
- **åŠŸèƒ½**: æ·»åŠ æ–°æˆå‘˜åˆ°ç¾¤ç»„
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```json
{
  "userIds": [10005, 10006, 10007],
  "inviterId": 10001
}
```

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "æ·»åŠ æˆåŠŸ",
  "data": {
    "groupId": "group_001",
    "addedCount": 3,
    "failedUsers": [],
    "currentMemberCount": 53
  }
}
```

---

## 6. ç§»é™¤æˆå‘˜

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}/members/{userId}`
- **Method**: `DELETE`
- **åŠŸèƒ½**: ç§»é™¤ç¾¤ç»„æˆå‘˜ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```
DELETE /api/v1/groups/group_001/members/10005
```

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "å·²ç§»é™¤æˆå‘˜",
  "data": {
    "groupId": "group_001",
    "removedUserId": 10005,
    "currentMemberCount": 52
  }
}
```

---

## 7. è·å–æˆå‘˜åˆ—è¡¨

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}/members`
- **Method**: `GET`
- **åŠŸèƒ½**: è·å–ç¾¤ç»„æˆå‘˜åˆ—è¡¨
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```
GET /api/v1/groups/group_001/members?page=1&size=20&role=ALL
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| page | integer | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| size | integer | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20 |
| role | string | å¦ | è§’è‰²ç­›é€‰ï¼šALL/OWNER/ADMIN/MEMBER |

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 52,
    "page": 1,
    "size": 20,
    "members": [
      {
        "userId": 10001,
        "username": "zhangsan",
        "nickname": "å¼ ä¸‰",
        "avatar": "https://cdn.example.com/avatar/10001.jpg",
        "role": "OWNER",
        "joinedAt": "2025-01-01T00:00:00Z"
      },
      {
        "userId": 10002,
        "username": "lisi",
        "nickname": "æå››",
        "avatar": "https://cdn.example.com/avatar/10002.jpg",
        "role": "ADMIN",
        "joinedAt": "2025-01-02T00:00:00Z"
      }
    ]
  }
}
```

---

## 8. è®¾ç½®ç®¡ç†å‘˜

### æ¥å£ä¿¡æ¯
- **URL**: `/{groupId}/admins`
- **Method**: `POST`
- **åŠŸèƒ½**: è®¾ç½®æˆ–å–æ¶ˆç¾¤ç®¡ç†å‘˜ï¼ˆä»…ç¾¤ä¸»ï¼‰
- **è®¤è¯**: éœ€è¦ Bearer Token

### Request
```json
{
  "userId": 10002,
  "action": "ADD"
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| userId | number | æ˜¯ | ç”¨æˆ·ID |
| action | string | æ˜¯ | æ“ä½œï¼šADD/REMOVE |

### Response - æˆåŠŸ (200)
```json
{
  "code": 200,
  "message": "è®¾ç½®æˆåŠŸ",
  "data": {
    "groupId": "group_001",
    "userId": 10002,
    "role": "ADMIN"
  }
}
```

---

## ç¾¤ç»„è§’è‰²

| è§’è‰² | æƒé™ |
|------|------|
| OWNER | ç¾¤ä¸»ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™ |
| ADMIN | ç®¡ç†å‘˜ï¼Œå¯ç®¡ç†æˆå‘˜ã€ä¿®æ”¹ç¾¤ä¿¡æ¯ |
| MEMBER | æ™®é€šæˆå‘˜ï¼Œå¯å‘é€æ¶ˆæ¯ |

---

## åŠ å…¥æ–¹å¼

| ç±»å‹ | è¯´æ˜ |
|------|------|
| FREE | è‡ªç”±åŠ å…¥ï¼Œæ— éœ€å®¡æ‰¹ |
| APPROVAL | éœ€è¦ç®¡ç†å‘˜å®¡æ‰¹ |
| INVITE_ONLY | ä»…é‚€è¯·ï¼Œä¸å¯æœç´¢ |

---

## æ•°æ®æ¨¡å‹

### Group
```typescript
interface Group {
  groupId: string;          // ç¾¤ç»„ID
  name: string;             // ç¾¤ç»„åç§°
  description: string;      // ç¾¤ç»„æè¿°
  avatar: string;           // ç¾¤ç»„å¤´åƒ
  ownerId: number;          // ç¾¤ä¸»ID
  memberCount: number;      // æˆå‘˜æ•°é‡
  maxMembers: number;       // æœ€å¤§æˆå‘˜æ•°
  joinType: JoinType;       // åŠ å…¥æ–¹å¼
  announcement: string;     // ç¾¤å…¬å‘Š
  createdAt: string;        // åˆ›å»ºæ—¶é—´
  updatedAt: string;        // æ›´æ–°æ—¶é—´
}

interface GroupMember {
  userId: number;           // ç”¨æˆ·ID
  username: string;         // ç”¨æˆ·å
  nickname: string;         // æ˜µç§°
  avatar: string;           // å¤´åƒ
  role: MemberRole;         // è§’è‰²
  joinedAt: string;         // åŠ å…¥æ—¶é—´
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2025-11-09  
**ç»´æŠ¤äºº**: å¼€å‘å›¢é˜Ÿ
